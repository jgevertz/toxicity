# toxicity
The MATLAB codes in this repository were used to generate the figures in "Delaying Cancer Progression by Integrating Toxicity Constraints in a Model of Adaptive Therapy".
- toxicity_daily_vs_adaptive.m: Simulation of the model subject to the four treatment protocols (daily, adaptive, daily+tox, adaptive+tox). The parameters and thresholds set in the code are used to generate Figure 2 in the manuscript, though parameters can be changed to generate Figure S1.
- sweeps_toxicity_daily_vs_adaptive.m: Performs parameter and threshold sweeps and quantifies the impact on time to progression across four treatment protocols. This code is used to generate Figures 4, 7, and S2. It also generates many other figures that are not included in the manuscript. Changing the value of the parameter beta in this code will also give the results shown in Figure S3. 
- sweeps_toxicity_fraction_resistant.m: Performs parameter and threshold sweeps and quantifies the impact on the resistance fraction at the time the tumor has progressed. This cod ei sued to generate Figures 5 and 6. It also generates many other figures that are not included in the manuscript.
- sweep_VP_5params.m: Generates virtual patients by randomly and independently sampling the lognormal distributions shown in Figure S4 of the manuscript. This code then quantifies the impact of changing protocol thresholds (either just the toxicity thresholds or just the adaptive thresholds) on this virtual population. These results are shown in Figure 8. 
- sweep_VP_5params_4Dprotocol.m: Extension of the prior virtual population code to also test impact of simultaneously varying the toxicity and the adaptive thresholds simultaneouly.
- create_KM.m: Processes all virtual populatiion output and is used to make the Kaplan-Meier summary plot in Figure 9.
